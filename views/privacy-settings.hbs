
<body>

    <div class="container mt-5 pt-4">
        <div class="card shadow-sm p-4">
            <h3 class="mb-4 text-center">Privacy Settings</h3>

            <!-- Change Password -->
            <h5>Change Password</h5>
            <form id="changePasswordForm">
                <div class="mb-3">
                    <label class="form-label">Current Password</label>
                    <input type="password" class="form-control" name="currentPassword" required>
                </div>
                <div class="mb-3">
                    <label class="form-label">New Password</label>
                    <input type="password" class="form-control" name="newPassword" required>
                </div>
                <div class="mb-3">
                    <label class="form-label">Confirm New Password</label>
                    <input type="password" class="form-control" name="confirmPassword" required>
                </div>
                <button type="submit" class="btn btn-primary">Update Password</button>
            </form>
            <hr>

            <!-- Delete Account -->
            <h5 class="text-danger">Delete Account</h5>
            <p class="text-muted">Enter your password to confirm account deletion.</p>
            <form>
                <div class="mb-3">
                    <label class="form-label">Password</label>
                    <input type="password" class="form-control">
                </div>
                <button type="submit" class="btn btn-danger">Delete Account</button>
            </form>
        </div>
    </div>
</body>


<script>
document.getElementById("changePasswordForm").addEventListener("submit", async (e) => {
    e.preventDefault();

    const form = e.target;
    const currentPassword = form.currentPassword.value;
    const newPassword = form.newPassword.value;
    const confirmPassword = form.confirmPassword.value;
    const msg = document.getElementById("passwordMsg");

    if (newPassword !== confirmPassword) {
        msg.textContent = "New passwords do not match.";
        msg.style.color = "red";
        return;
    }

    try {
        const response = await fetch("/api/profile/me/privacy", {
            method: "PUT",
            headers: {
                "Content-Type": "application/json",
                // Include auth header if needed, like:
                // "Authorization": `Bearer ${token}`
            },
            body: JSON.stringify({ currentPassword, newPassword }),
        });

        const result = await response.json();

        if (response.ok) {
            msg.textContent = "Password updated successfully!";
            msg.style.color = "green";
            form.reset();
        } else {
            msg.textContent = `${result.error || 'Failed to update password.'}`;
            msg.style.color = "red";
        }
    } catch (err) {
        msg.textContent = "Something went wrong.";
        msg.style.color = "red";
        console.error(err);
    }
});
</script>